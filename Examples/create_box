import os
import tempfile
import time

from ansys.aedt.core import Hfss

# ### Define constants
AEDT_VERSION = "2024.2"
NUM_CORES = 4
NG_MODE = False  # Open AEDT UI when it is launched.

# ### Create temporary directory
#
# Create a temporary working directory.
# The name of the working folder is stored in ``temp_folder.name``.
#
# > **Note:** The final cell in this notebook cleans up the temporary folder. If you want to
# > retrieve the AEDT project and data, do so before executing the final cell in the notebook.

temp_folder = tempfile.TemporaryDirectory(suffix=".ansys")

# ### Launch HFSS
#
# Create an instance of
# the ``Hfss`` class. The Ansys Electronics Desktop will be launched
# with an active HFSS design. The ``hfss`` object is subsequently
# used to
# create and simulate the dipole antenna.

project_name = os.path.join(temp_folder.name, "dipole2.aedt")
hfss = Hfss(version=AEDT_VERSION,
            non_graphical=NG_MODE,
            project=project_name,
            new_desktop=True,
            solution_type="Modal",
            )

hfss.release_desktop(close_projects=True, close_on_exit=True)


# Criar box paralelepipedo
box =hfss.modeler.create_box([1,1,1],[5,2,5], name="box",material="FR4_epoxy")
#print(box.name)